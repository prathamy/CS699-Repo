<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
	<script defer src="https://pyscript.net/alpha/pyscript.js"></script>


    <title>Flight Tracker</title>

    <py-env>
        - matplotlib
    </py-env>

    </style>
</head>
<body>
<div id="main">
    <h1>Flight Tracker Demo</h1>

    <form method="GET">
        <div>

                <select name="from" id="from">
                  <option value="BOM-Mumbai">MUMBAI</option>
                  <option value="DEL-Delhi">DELHI</option>
                  <option value="CCU-Kolkata">KOLKATA</option>
                  <option value="BLR-Bengaluru">BANGLORE</option>
                  <option value="MAA-Chennai">CHENNAI</option>
                  <option value="PNQ-Pune">PUNE</option>
                  <option value="LKO-Lucknow">LUCKNOW</option>
                </select>


                <select name="to" id="to">
                    <option value="BOM-Mumbai">MUMBAI</option>
                    <option value="DEL-Delhi">DELHI</option>
                    <option value="CCU-Kolkata">KOLKATA</option>
                    <option value="BLR-Bengaluru">BANGLORE</option>
                    <option value="MAA-Chennai">CHENNAI</option>
                    <option value="PNQ-Pune">PUNE</option>
                    <option value="LKO-Lucknow">LUCKNOW</option>
                  </select>



                  <select name="date" id="date">
                    <option value="01">1</option>
                    <option value="02">2</option>
                    <option value="03">3</option>
                    <option value="04">4</option>
                    <option value="05">5</option>
                    <option value="06">6</option>
                    <option value="07">7</option>
                    <option value="08">8</option>
                    <option value="09">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                  </select>


                  <select name="month" id="month">
                    <option value="01">January</option>
                    <option value="02">February</option>
                    <option value="03">March</option>
                    <option value="04">April</option>
                    <option value="05">May</option>
                    <option value="06">June</option>
                    <option value="07">July</option>
                    <option value="08">August</option>
                    <option value="09">September</option>
                    <option value="10">October</option>
                    <option value="11">November</option>
                    <option value="12">December</option>
                  </select>


                   <select name="year" id="year">
                    <option value="2022">2022</option>
                    <option value="2023">2023</option>
                  </select>

            <input type="text" id="city" value="{{ request.GET.city }}"  name="city"/>


        </div>
        <input type="submit" value="Submit"/>
    </form>

    {% if result %}
        <h3 id= "p_price">{{ result.paytm_price }}</h3>
        <h3 id= "f_price">{{ result.flipkart_price }}</h3>
        <h3 id= "e_price">{{ result.easemy_price }}</h3>
        <h3 id= "p_airlines">{{ result.paytm_airlines }}</h3>
        <h3 id= "f_airlines">{{ result.flipkart_airlines }}</h3>
        <h3 id= "e_airlines">{{ result.flipkart_airlines }}</h3>

        <py-script>
          
            import matplotlib.pyplot as plt
            import re

            p_price=document.getElementById("p_price").innerHTML
            f_price=document.getElementById("f_price").innerHTML
            e_price=document.getElementById("e_price").innerHTML
            p_airlines=document.getElementById("p_airlines").innerHTML
            f_airlines=document.getElementById("f_airlines").innerHTML
            e_airlines=document.getElementById("e_airlines").innerHTML

            #print(p_price, f_price, e_price, p_airlines , f_airlines)
          
            f_price=f_price[1:]

            p_price=int(re.sub(",","",p_price))
            f_price=int(re.sub(",","",f_price))
            e_price=int(re.sub(",","",e_price))
           

            fig, ax = plt.subplots()
            
            price = [p_price, f_price, e_price]
            site = ["Paytm", "Flipkart", "EasemyTrip"]
            col=['blue' , 'yellow' , 'red']
            
            
            
            plt.bar(site, price , color = col )
            
            plt.xlabel('Site')
            plt.ylabel('Price in INR')
            plt.title('Price vs Site')
            
            fig

        </py-script>
        {% comment %} <h3>{{ result.weather_now }}</h3> {% endcomment %}
    {% endif %}     

   

</div>
</body>
</html>